<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–†–∞—Å—á—ë—Ç –æ–ø–ª–∞—Ç—ã</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f7f7;
      padding: 16px;
    }
    h2 {
      text-align: center;
    }
    label {
      display: block;
      margin-top: 12px;
      font-weight: bold;
    }
    input {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      font-size: 16px;
    }
    button {
      width: 100%;
      padding: 12px;
      margin-top: 16px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
    }
    .preview {
      background: #4CAF50;
      color: white;
    }
    .clear {
      background: #ccc;
    }
  </style>
</head>

<body>
  <h2 id="date"></h2>

  <label>üíµ –¶–µ–Ω–∞ –∑–∞–ª–∞ –∑–∞ 1 —á–∞—Å</label>
  <input id="hallPrice" type="number" placeholder="1500">

  <label>üïë –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤ –∞—Ä–µ–Ω–¥—ã</label>
  <input id="totalHours" type="number" placeholder="5" onchange="renderHours()">

  <label>üë• –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤</label>
  <input id="totalPlayers" type="number" placeholder="19">

  <div id="hoursBlock"></div>

  <button class="preview" onclick="sendPreview()">üëÄ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
  <button class="clear" onclick="clearAll()">üîÑ –û—á–∏—Å—Ç–∏—Ç—å</button>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

document.getElementById('date').innerText = getDate();

function getDate() {
  const d = new Date();
  const days = ['–í–û–°–ö–†–ï–°–ï–ù–¨–ï','–ü–û–ù–ï–î–ï–õ–¨–ù–ò–ö','–í–¢–û–†–ù–ò–ö','–°–†–ï–î–ê','–ß–ï–¢–í–ï–†–ì','–ü–Ø–¢–ù–ò–¶–ê','–°–£–ë–ë–û–¢–ê'];
  return `üìÖ ${days[d.getDay()]} ${d.toLocaleDateString('ru-RU')}`;
}

function renderHours() {
  const hours = Number(document.getElementById('totalHours').value);
  const block = document.getElementById('hoursBlock');
  block.innerHTML = '';

  if (!hours || hours < 1) return;

  block.innerHTML += `<label>‚è± –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤ –ø–æ —á–∞—Å–∞–º</label>`;

  for (let i = 1; i <= hours; i++) {
    block.innerHTML += `
      <input type="number"
             placeholder="${i} —á–∞—Å(–∞)"
             data-hour="${i}">
    `;
  }
}

function sendPreview() {
  const data = {
    hallPrice: Number(document.getElementById('hallPrice').value),
    totalHours: Number(document.getElementById('totalHours').value),
    totalPlayers: Number(document.getElementById('totalPlayers').value),
    playersByHours: {}
  };

  document.querySelectorAll('[data-hour]').forEach(i => {
    const v = Number(i.value);
    if (v > 0) data.playersByHours[i.dataset.hour] = v;
  });

  tg.sendData(JSON.stringify(data));
}

function clearAll() {
  document.querySelectorAll('input').forEach(i => i.value = '');
  document.getElementById('hoursBlock').innerHTML = '';
}
</script>
</body>
</html>