<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–†–∞—Å—á—ë—Ç –æ–ø–ª–∞—Ç—ã</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
body { font-family: Arial; padding: 16px; }
input { width: 100%; padding: 8px; margin-bottom: 10px; }
button { width: 100%; padding: 12px; font-size: 16px; }
</style>
</head>

<body>
<h3>üìÖ –†–∞—Å—á—ë—Ç –æ–ø–ª–∞—Ç—ã</h3>

<input id="price" type="number" placeholder="üíµ –¶–µ–Ω–∞ –∑–∞–ª–∞ –∑–∞ 1 —á–∞—Å">
<input id="hours" type="number" placeholder="üïë –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤">
<input id="players" type="number" placeholder="üë• –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤">

<h4>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤</h4>
<div id="distribution"></div>

<button onclick="preview()">üëÄ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

document.getElementById('hours').addEventListener('input', renderHours);

function renderHours() {
  const hours = Number(document.getElementById('hours').value);
  const div = document.getElementById('distribution');
  div.innerHTML = '';

  for (let h = 1; h <= hours; h++) {
    div.innerHTML += `
      <input type="number"
        placeholder="${h} —á–∞—Å(–∞) ‚Äî —Å–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫"
        id="h${h}">
    `;
  }
}

function preview() {
  const hallPrice = Number(price.value);
  const totalHours = Number(hours.value);
  const totalPlayers = Number(players.value);

  const playersByHours = {};
  for (let h = 1; h <= totalHours; h++) {
    const v = Number(document.getElementById('h' + h).value || 0);
    if (v > 0) playersByHours[h] = v;
  }

  tg.sendData(JSON.stringify({
    hallPrice,
    totalHours,
    totalPlayers,
    playersByHours
  }));
}
</script>
</body>
</html>